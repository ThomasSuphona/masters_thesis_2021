%Take the images from the Undistorted folder to the Binarized folder
%You only have to change the nameFolder.

%% Parameters

%name of the folder
% names = {'input_videos\C10B838P0M','input_videos\C10B838P1M','input_videos\C10B838P2M'...
%     'input_videos\C10B838P3M','input_videos\C15B838P0M','input_videos\C15B838P1M',...
%     'input_videos\C15B838P2M','input_videos\C15B838P3M',...
%     'input_videos\C20B838P0M','input_videos\C20B838P1M','input_videos\C20B838P2M',...
%     'input_videos\C20B838P3M','input_videos\C25B838P0M','input_videos\C25B838P1M',...
%     'input_videos\C25B838P2M','input_videos\C25B838P3M','input_videos\C30B838P0M',...
%     'input_videos\C30B838P1M','input_videos\C30B838P2M','input_videos\C30B838P3M'};
    
% '0W100C10B','0W100C15B','0W100C20B','0W100C25B',...
%     '0W200C1B','0W200C2B','0W200C5B','0W200C10B','0W200C16B','0W200C21B','0W200C26B',...
%     '0W400C1B','0W400C2B','0W400C5B','0W400C10B','0W400C15B','0W400C20B','0W400C25B',...
%     '0W500C1B','0W500C2B','0W500C5B','0W500C10B','0W500C15B','0W500C20B','0W500C25B',...
%     '0W600C1B','0W600C2B','0W600C5B','0W600C10B','0W600C15B','0W600C20B','0W600C25B',...
%     '0W700C1B','0W700C2B','0W700C5B','0W700C10B','0W700C15B','0W700C20B','0W700C25B',...
%     '1W100C1B','1W100C2B','1W100C5B','1W100C10B','1W100C15B','1W100C20B','1W100C25B',...
%     '1W200C1B','1W200C2B','1W200C5B','1W200C10B','1W200C15B','1W200C20B','1W200C25B',...
%     '1W300C1B','1W300C2B','1W300C5B','1W300C10B','1W300C15B','1W300C20B','1W300C25B',...
%     '1W400C1B','1W400C2B','1W400C5B','1W400C10B','1W400C15B','1W400C20B','1W400C25B',...
%     '1W500C1B','1W500C2B','1W500C5B','1W500C10B','1W500C15B','1W500C20B','1W500C25B',...
%     '1W600C1B','1W600C2B','1W600C5B','1W600C10B','1W600C15B','1W600C20B','1W600C25B',...
%     '1W700C1B','1W700C2B','1W700C5B','1W700C10B','1W700C15B','1W700C20B','1W700C25B',...
%     '2W100C1B','2W100C2B','2W100C5B','2W100C10B','2W100C15B','2W100C20B','2W100C25B',...
%     '2W200C1B','2W200C2B','2W200C5B','2W200C10B','2W200C15B','2W200C20B','2W200C25B',...
%     '2W300C1B','2W300C2B','2W300C5B','2W300C10B','2W300C15B','2W300C20B','2W300C25B',...
%     '2W400C1B','2W400C2B','2W400C5B','2W400C10B','2W400C15B','2W400C20B','2W400C25B',...
%     '2W500C1B','2W500C2B','2W500C5B','2W500C10B','2W500C15B','2W500C20B','2W500C25B',...
%     '2W600C1B','2W600C2B','2W600C5B','2W600C10B','2W600C15B','2W600C20B','2W600C25B',...
%     '2W700C1B','2W700C2B','2W700C5B','2W700C10B','2W700C15B','2W700C20B','2W700C25B',...
%     '3W100C1B','3W100C2B',
% names = {'3W100C5B','3W100C10B','3W100C15B','3W100C20B','3W100C25B',...
%     '3W200C1B','3W200C2B','3W200C5B','3W200C10B','3W200C15B','3W200C20B','3W200C25B',...
%     '3W300C1B','3W300C2B','3W300C5B','3W300C10B','3W300C15B','3W300C20B','3W300C25B',...
%     '3W400C1B','3W400C2B','3W400C5B','3W400C10B','3W400C15B','3W400C20B','3W400C25B'};

names = {'1W1300C1B'};

%threshold for the binarization
threshold = 230;

for ii=1:numel(names)
    
nameFolder = names{ii};

%crop of the image
%rect = [310  260 1220-310 1050-260]; %[xmin ymin width height]
rect = [330 0 1265 1075]; %new_conditions_2

%%

parentFolder = fullfile('..\Image_Sequences');

%The input folder with the undistorted images
inputFolder = fullfile(parentFolder, 'Undistorted', nameFolder);

%create the output folder
mkdir(fullfile(parentFolder, 'Binarized', nameFolder));

%calculate the number of images
D=dir([inputFolder '\*.jpg']);
nImages = numel(D);

disp(nImages)
%kk=1;
for kk = 1:nImages

    inputName = fullfile(inputFolder, D(kk).name); %full name of the image
    img = imread(inputName);
    
    %binarize the image
    img = rgb2gray(img); %make the image in gray scale
    img = imcomplement(img); %invert black and white
    img = img > threshold; %binarize

    %crop the image 
    img = imcrop(img, rect);
    
    %write the image in the Binarized folder
    filename = [sprintf('%05.0f', kk), '.tiff']; %name of the frame
    outputName = fullfile(parentFolder, 'Binarized', nameFolder, filename);
    imwrite(img, outputName) %write out to a JPEG file
    
    if floor(kk/200)==kk/200 
        disp(kk) 
    end    
end

end